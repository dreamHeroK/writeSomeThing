# JavaScript ä¸­æ™®é€šå‡½æ•°å’Œç®­å¤´å‡½æ•°çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ

ä½œè€…ï¼šJames Sinclair

2025å¹´6æœˆ29æ—¥

## ç›®å½•

1. å‡½æ•°å£°æ˜å’Œå‡½æ•°è¯­å¥
2. ç®­å¤´å‡½æ•°
3. æˆ‘ä»¬åº”è¯¥ä½¿ç”¨å“ªç§å‡½æ•°è¯­æ³•ï¼Ÿ
4. æ€»ç»“

ç®­å¤´å‡½æ•°ï¼ˆä¹Ÿè¢«ç§°ä¸º"ç«ç®­"å‡½æ•°ï¼‰ç®€æ´ä¸”æ–¹ä¾¿ã€‚ç„¶è€Œï¼Œä¸å‡½æ•°å£°æ˜å’Œå‡½æ•°è¡¨è¾¾å¼ç›¸æ¯”ï¼Œå®ƒä»¬æœ‰ä¸€äº›ç»†å¾®çš„å·®åˆ«ã€‚é‚£ä¹ˆä½ å¦‚ä½•çŸ¥é“è¯¥ä½¿ç”¨å“ªä¸€ç§ï¼Œä»¥åŠä»€ä¹ˆæ—¶å€™ä½¿ç”¨å‘¢ï¼Ÿ

## å‡½æ•°å£°æ˜å’Œå‡½æ•°è¯­å¥

åœ¨ JavaScript ä¸­ï¼Œæˆ‘ä»¬è‡³å°‘æœ‰ä¸‰ç§åˆ›å»ºå‡½æ•°çš„æ–¹å¼ã€‚ç¬¬ä¸€ç§æ˜¯å‡½æ•°å£°æ˜ã€‚è¿™ä¼šå°†ä¸€ä¸ªå‡½æ•°ç»‘å®šåˆ°ç»™å®šçš„åç§°ä¸Šã€‚å®ƒçœ‹èµ·æ¥åƒè¿™æ ·ï¼š

```javascript
// è¿™å°†åˆ›å»ºä¸€ä¸ªç»‘å®šåˆ°åç§° 'isVowel' çš„å‡½æ•°
function isVowel(chr) {
  const c = chr.toLowerCase();
  return ['a', 'e', 'i', 'o', 'u'].includes(c);
}
```

æˆ‘ä»¬å†™ `function` å…³é”®å­—ï¼Œåé¢è·Ÿç€ä¸€ä¸ªæ ‡è¯†ç¬¦æ¥å‘½åå‡½æ•°ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ`isVowel`ã€‚ä»¥è¿™ç§æ–¹å¼ç¼–å†™ï¼Œå‡½æ•°å£°æ˜æ˜¯ä¸€ä¸ªè¯­å¥ï¼Œè€Œä¸æ˜¯è¡¨è¾¾å¼ã€‚

åˆ›å»ºå‡½æ•°çš„ç¬¬äºŒç§æ–¹æ³•æ˜¯ä½¿ç”¨å‡½æ•°è¡¨è¾¾å¼ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·åˆ›å»ºä¸€ä¸ªå‡½æ•°ï¼š

```javascript
// è¿™é‡Œæˆ‘ä»¬å†™ä¸€ä¸ªåŒ¿åå‡½æ•°è¡¨è¾¾å¼ï¼Œå¹¶é€šè¿‡å˜é‡èµ‹å€¼å°†å…¶ç»‘å®šåˆ°ä¸€ä¸ªåç§°
const takeWhile = function(predicate, arr) {
  const idx = arr.findIndex((x) => !predicate(x));
  return idx === -1 ? arr : arr.slice(0, idx);
}
```

æˆ‘ä»¬å¯ä»¥å°†è¿™é‡Œå‘ç”Ÿçš„äº‹æƒ…åˆ†è§£ä¸ºä¸¤ä¸ªæ­¥éª¤ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªåŒ¿åå‡½æ•°ï¼Œä½¿ç”¨ `function` å…³é”®å­—ä½†æ²¡æœ‰åç§°ã€‚ç„¶åï¼Œæˆ‘ä»¬å°†è¿™ä¸ªåŒ¿åå‡½æ•°èµ‹å€¼ç»™å˜é‡ `takeWhile`ã€‚ä½¿ç”¨è¿™ç§è¯­æ³•ï¼Œå‡½æ•°å£°æ˜æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥å°†å®ƒèµ‹å€¼ç»™å˜é‡æˆ–ä¸å…¶ä»–è¡¨è¾¾å¼ç»“åˆä½¿ç”¨ã€‚

æœ‰äº›ä»¤äººå›°æƒ‘çš„æ˜¯ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç»™æˆ‘ä»¬çš„å‡½æ•°è¡¨è¾¾å¼ä¸€ä¸ªåç§°ã€‚ä¸€ä¸ªä¸å˜é‡ååˆ†ç¦»çš„åç§°ï¼š

```javascript
// æˆ‘ä»¬å°†å‡½æ•°èµ‹å€¼ç»™ä¸€ä¸ªå‘½åå˜é‡ï¼Œä½†å‡½æ•°è¡¨è¾¾å¼æœ¬èº«ä¹Ÿæœ‰ä¸€ä¸ªåç§°
const takeWhile = function takeyWhiley(predicate, arr) {
  const idx = arr.findIndex((x) => !predicate(x));
  return idx === -1 ? arr : arr.slice(0, idx);
}
```

å½“æˆ‘ä»¬è¿™æ ·åˆ›å»ºå‡½æ•°æ—¶ï¼Œåç§° `takeyWhiley` æ²¡æœ‰ç»‘å®šåˆ°ä½œç”¨åŸŸã€‚è¿™æ„å‘³ç€æˆ‘ä»¬ä¸èƒ½ä½¿ç”¨ `takeyWhiley` æ ‡è¯†ç¬¦è°ƒç”¨æˆ‘ä»¬çš„å‡½æ•°ï¼š

```javascript
// è¿™ä¸èµ·ä½œç”¨
takeyWhiley(isVowel, 'aeiobc'.split(''));
// ReferenceError: takeyWhiley is not defined
```

è¿™ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚å¦‚æœæˆ‘ä»¬ä¸èƒ½ä½¿ç”¨é‚£ä¸ªåç§°ï¼Œé‚£ä¹ˆå®ƒçš„æ„ä¹‰æ˜¯ä»€ä¹ˆï¼Ÿå—¯ï¼Œå¦‚æœæˆ‘ä»¬åœ¨ä»£ç ä¸­æŠ›å‡ºé”™è¯¯ï¼Œ`takeyWhiley` ä¼šå‡ºç°ã€‚ä¾‹å¦‚ï¼š

```javascript
const takeWhile = function takeyWhiley(predicate, arr) {
  throw new Error('a bad thing happened');
  const idx = arr.findIndex((x) => !predicate(x));
  return idx === -1 ? arr : arr.slice(0, idx);
}

takeWhile(isVowel, 'aeiobc'.split(''));
// Error: a bad thing happened
//     at takeyWhiley (<anonymous>:12:9)
//     at <anonymous>:16:1
```

å½“æˆ‘ä»¬æŠ›å‡ºé”™è¯¯æ—¶ï¼Œæˆ‘ä»¬çš„ `takeyWhiley` åç§°ä¼šå›æ¥ã€‚JS è¿è¡Œæ—¶ä½¿ç”¨å‡½æ•°è¡¨è¾¾å¼çš„åç§°è€Œä¸æ˜¯ç»‘å®šçš„å˜é‡åã€‚

ä¸è¿‡ï¼Œåœ¨å¤§å¤šæ•°æ–¹é¢ï¼Œå‡½æ•°è¡¨è¾¾å¼è¡¨ç°å¾—åƒå‡½æ•°å£°æ˜ã€‚ä½†æœ‰ä¸€äº›ç»†å¾®å·®åˆ«éœ€è¦æ³¨æ„ã€‚

1. å‡½æ•°å£°æ˜è¢« JavaScript è¿è¡Œæ—¶"æå‡"ã€‚è¿è¡Œæ—¶å°†å®ƒä»¬è§†ä¸ºä½ åœ¨å£°æ˜å®ƒä»¬çš„ä½œç”¨åŸŸé¡¶éƒ¨ç¼–å†™äº†å‡½æ•°ã€‚æ— è®ºä½ åœ¨æ–‡ä»¶ä¸­çš„å“ªä¸ªä½ç½®ç¼–å†™å®ƒï¼Œå®ƒéƒ½ä¼šè¿™æ ·åšã€‚é€šå¸¸ï¼Œè¿™ä¼šå¯¼è‡´ä»£ç æŒ‰ä½ æœŸæœ›çš„æ–¹å¼å·¥ä½œã€‚ä¸è¿‡ï¼Œåœ¨æå°‘æ•°æƒ…å†µä¸‹ï¼Œå®ƒå¯èƒ½ä¼šå¯¼è‡´ä»¤äººæƒŠè®¶çš„è¡Œä¸ºã€‚
2. å‡è®¾ä½ åˆ›å»ºä¸€ä¸ªåŒ¿åå‡½æ•°è¡¨è¾¾å¼å¹¶å°†å…¶èµ‹å€¼ç»™å˜é‡ã€‚JS å¼•æ“é€šå¸¸å¾ˆæ“…é•¿å¼„æ¸…æ¥šå˜é‡åå°±æ˜¯å‡½æ•°çš„åç§°ã€‚ä¸è¿‡ï¼Œæœ‰æ—¶ JS è¿è¡Œæ—¶å¯èƒ½ä¼šä¸¢å¤±å˜é‡åçš„è·Ÿè¸ªã€‚å½“ä½ åœ¨è°ƒè¯•æŸäº›ä¸œè¥¿æ—¶æŸ¥çœ‹å †æ ˆè·Ÿè¸ªæ—¶ï¼Œè¿™å¯èƒ½æ˜¯ä¸€ä¸ªé—®é¢˜ã€‚æ‰€ä»¥ï¼Œå¦‚æœè¯¥åç§°éœ€è¦åœ¨å †æ ˆè·Ÿè¸ªä¸­å‡ºç°ï¼Œæœ€å¥½å‘½åå‡½æ•°ã€‚

## ç®­å¤´å‡½æ•°

åˆ›å»ºå‡½æ•°çš„ç¬¬ä¸‰ç§æ–¹æ³•æ˜¯ä½¿ç”¨ç®­å¤´å‡½æ•°è¡¨è¾¾å¼ã€‚è¿™äº›æœ‰æ—¶è¢«ç§°ä¸º"ç«ç®­"å‡½æ•°ã€‚å®ƒå¯èƒ½çœ‹èµ·æ¥åƒè¿™æ ·ï¼š

```javascript
const dropWhile = (predicate, arr) => {
  const idx = arr.findIndex((x) => !predicate(x));
  return idx === -1 ? [] : arr.slice(idx);
}
```

æ³¨æ„ç®­å¤´å‡½æ•°æ€»æ˜¯åŒ¿åçš„ï¼Œæ€»æ˜¯è¡¨è¾¾å¼ã€‚é™¤éæˆ‘ä»¬å°†å®ƒä»¬èµ‹å€¼ç»™å˜é‡ï¼Œå¦åˆ™æˆ‘ä»¬ä¸èƒ½ç»™å®ƒä»¬å‘½åã€‚

ç®­å¤´å‡½æ•°ä¸å…¶ä»–ä¸¤ç§å‡½æ•°çš„ä¸»è¦åŒºåˆ«æ˜¯å®ƒæ›´ç®€æ´ã€‚æˆ‘ä»¬æ²¡æœ‰é‚£ä¸ªå†—é•¿çš„ `function` å…³é”®å­—ï¼Œåªæœ‰ä¸¤ä¸ªçœ‹èµ·æ¥åƒç®­å¤´çš„å­—ç¬¦ã€‚å®ƒä»¬ç”šè‡³æ¯”ä¸Šé¢çš„ä¾‹å­æ›´ç®€æ´ã€‚å¦‚æœæˆ‘ä»¬å°†å‡½æ•°ä½“å‹ç¼©ä¸ºä¸€ä¸ªè¡¨è¾¾å¼ï¼Œæˆ‘ä»¬å¯ä»¥å»æ‰èŠ±æ‹¬å·å’Œ `return` å…³é”®å­—ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯èƒ½é‡æ„ `dropWhile()` æ¥ä½¿ç”¨è¾…åŠ©å‡½æ•° `modLength()`ï¼š

```javascript
// æˆ‘ä»¬çš„ modLength() å‡½æ•°åœ¨å‡½æ•°ä½“å‘¨å›´æ²¡æœ‰èŠ±æ‹¬å·
// å®ƒæœ‰ä¸€ä¸ªè¡¨è¾¾å¼ä½œä¸ºä¸»ä½“ï¼Œå½“è°ƒç”¨æ—¶è¿”å›è¯¥è¡¨è¾¾å¼çš„å€¼
const modLength = (len, x) => x < 0 ? len : x;

// æˆ‘ä»¬è¿”å›çš„å€¼ä¸é™äºåŸå§‹ç±»å‹
// å®ƒä»¬å¯ä»¥æ˜¯æ•°ç»„ã€å¯¹è±¡ï¼Œç”šè‡³æ˜¯æ–°å‡½æ•°
const dropWhile = (predicate, arr) =>
  arr.slice(
    modLength(
      arr.length,
      arr.findIndex((x) => !predicate(x))
    )
  );
```

æˆ‘ä»¬ä¹Ÿå¯ä»¥å»æ‰åœ†æ‹¬å·ï¼Œå¦‚æœç®­å¤´å‡½æ•°æ¥å—å•ä¸ªå‚æ•°ã€‚ä¾‹å¦‚ï¼š

```javascript
const CONSONANTS = 'bcdfghjklmnpqrstvwzyz';

// æˆ‘ä»¬çš„ isConsonant() å‡½æ•°æ¥å—å•ä¸ªå‚æ•° c
const isConsonant = c => CONSONANTS.includes(c.toLowerCase());
```

ç®€æ´æ€§ä¸æ˜¯ç®­å¤´å‡½æ•°å’Œå‘½åå‡½æ•°ä¹‹é—´çš„å”¯ä¸€åŒºåˆ«ã€‚è¿˜æœ‰ä¸€äº›å…¶ä»–å…³é”®åŒºåˆ«ï¼Œæ­£å¦‚ MDN å…³äºç®­å¤´å‡½æ•°çš„é¡µé¢æ‰€æŒ‡å‡ºçš„ï¼š

> * ç®­å¤´å‡½æ•°æ²¡æœ‰è‡ªå·±çš„ `this`ã€`arguments` æˆ– `super` ç»‘å®šï¼Œä¸åº”è¯¥ç”¨ä½œæ–¹æ³•ã€‚
> * ç®­å¤´å‡½æ•°ä¸èƒ½ç”¨ä½œæ„é€ å‡½æ•°ã€‚ç”¨ `new` è°ƒç”¨å®ƒä»¬ä¼šæŠ›å‡º `TypeError`ã€‚å®ƒä»¬ä¹Ÿæ²¡æœ‰è®¿é—® `new.target` å…³é”®å­—ã€‚
> * ç®­å¤´å‡½æ•°ä¸èƒ½åœ¨å‡½æ•°ä½“å†…ä½¿ç”¨ `yield`ï¼Œä¸èƒ½åˆ›å»ºä¸ºç”Ÿæˆå™¨å‡½æ•°ã€‚

ä¸è¿‡ï¼Œè¿™ä¸€åˆ‡æ„å‘³ç€ä»€ä¹ˆï¼Ÿæˆ‘ä»¬å¦‚ä½•ç¡®å®šåœ¨ä»£ç ä¸­ä½¿ç”¨å“ªä¸€ä¸ªï¼Ÿ

### ç®­å¤´å‡½æ•°å’Œ `this`

è¦ç¡®å®šä½¿ç”¨å“ªç§å‡½æ•°ç±»å‹ï¼Œç¬¬ä¸€ä¸ªè¦é—®çš„é—®é¢˜æ˜¯ï¼šè¿™ä¸ªå‡½æ•°ä¼šä½¿ç”¨ `this` å…³é”®å­—åšä»»ä½•äº‹æƒ…å—ï¼Ÿå½“æ¶‰åŠ `this` æ—¶ï¼Œç®­å¤´å‡½æ•°çš„è¡Œä¸ºä¸å‡½æ•°ä¸åŒã€‚ä¾‹å¦‚ï¼š

```javascript
function funcCite() {
  return `'${this.title}' by ${this.author}`
}

const arrowCite = () => `'${this.title}' by ${this.author}`;
```

åœ¨è¡¨é¢ä¸Šï¼Œ`funcCite()` å’Œ `arrowCite()` ä¼¼ä¹å…·æœ‰ç›¸åŒçš„åŠŸèƒ½ã€‚ä½†å¦‚æœæˆ‘ä»¬å¯¹å¯¹è±¡ä½¿ç”¨å®ƒä»¬ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ

```javascript
const book = {
  title: 'The Hound of the Baskervilles',
  author: 'Arthur Conan Doyle',
  funcCite: funcCite,
  arrowCite: arrowCite,
}

console.log(book.funcCite());
// íºµ 'The Hound of the Baskervilles' by Arthur Conan Doyle
console.log(book.arrowCite());
// íºµ 'undefined' by undefined
```

å¦‚æœæˆ‘ä»¬çš„å‡½æ•°ä¸ä½¿ç”¨ `this` å…³é”®å­—ï¼Œé‚£ä¹ˆç®­å¤´å‡½æ•°å’Œæ™®é€šå‡½æ•°ä¹‹é—´æ²¡æœ‰åŒºåˆ«ã€‚ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬çš„å‡½æ•°ç¡®å®ä½¿ç”¨ `this`ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦å°å¿ƒã€‚

### ç®­å¤´å‡½æ•°å’Œæ„é€ å‡½æ•°

ç®­å¤´å‡½æ•°ä¸èƒ½ç”¨ä½œæ„é€ å‡½æ•°ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬ä¸èƒ½ä½¿ç”¨ `new` å…³é”®å­—æ¥åˆ›å»ºå¯¹è±¡ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬ä¼šåšå¦‚ä¸‹çš„äº‹æƒ…ï¼š

```javascript
function Book(title, author) {
  this.title = title;
  this.author = author;
}

Book.prototype.cite = function() {
  return `'${this.title}' by ${this.author}`;
}

const myBook = new Book(
  'The Hound of the Baskervilles',
  'Arthur Conan Doyle'
);

console.log(myBook.cite());
// íºµ 'The Hound of the Baskervilles' by Arthur Conan Doyle
```

å®é™…ä¸Šï¼Œåœ¨åº•å±‚ï¼Œè¿™ä¸¤ç§åˆ›å»º `Book` ç±»çš„æ–¹å¼æœ¬è´¨ä¸Šæ˜¯ç›¸åŒçš„ã€‚`class` å…³é”®å­—åªæ˜¯ä¸ºä¹ æƒ¯ OO è¯­è¨€çš„äººæä¾›äº†ä¸€ä¸ªæ›´ç†Ÿæ‚‰çš„æ¥å£ã€‚

ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬å°è¯•å¯¹ç®­å¤´å‡½æ•°ä½¿ç”¨ `new`ï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°ä¸€ä¸ªé”™è¯¯ï¼š

```javascript
// Book ç°åœ¨æ˜¯ä¸€ä¸ªç®­å¤´å‡½æ•°
const Book = (title, author) => {
  this.title = title;
  this.author = author;
}

// è¿™ä¸èµ·ä½œç”¨
const myBook = new Book(
  'The Hound of the Baskervilles',
  'Arthur Conan Doyle'
);
// TypeError: Book is not a constructor
```

### ç®­å¤´å‡½æ•°å’Œç”Ÿæˆå™¨

æˆ‘ä»¬ä¸èƒ½åœ¨éç”Ÿæˆå™¨å‡½æ•°å®šä¹‰ï¼ˆåŒ…æ‹¬ç®­å¤´å‡½æ•°çš„ä¸»ä½“ï¼‰å†…ä½¿ç”¨ `yield` å…³é”®å­—ã€‚è¿™æ„å‘³ç€åœ¨å¤„ç†ç”Ÿæˆå™¨å‡½æ•°æ—¶æˆ‘ä»¬å¿…é¡»å°å¿ƒã€‚ä¾‹å¦‚ï¼Œä»¥ä¸‹ä»£ç ä¼šäº§ç”Ÿè§£æé”™è¯¯ï¼š

```javascript
// è¿™ä¸èµ·ä½œç”¨
function* oneToTen() {
  // æˆ‘ä»¬åœ¨ç”Ÿæˆå™¨å‡½æ•°å†…åˆ›å»ºä¸€ä¸ªç®­å¤´å‡½æ•°
  const yieldEven = (x) => {
    if (x % 2 === 0) {
       yield x;
    }
  }

  for (let i = 1; i <= 10; i++) yieldEven(x);
}
// Expression expected at file:///<filename>:7:8
```

JavaScript æ²¡æœ‰ç®­å¤´å‡½æ•°çš„ `function*` ç­‰ä»·ç‰©ã€‚å› æ­¤ï¼Œåœ¨å¤„ç†ç”Ÿæˆå™¨æ—¶ï¼Œæˆ‘ä»¬å¿…é¡»ä½¿ç”¨ `function*` è¯­æ³•ã€‚

## æˆ‘ä»¬åº”è¯¥ä½¿ç”¨å“ªç§å‡½æ•°è¯­æ³•ï¼Ÿ

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»ç ”ç©¶äº†ç®­å¤´å‡½æ•°**ä¸èƒ½**åšçš„äº‹æƒ…ã€‚ä½ å¯èƒ½ä¼šè®¤ä¸ºå‘½åå‡½æ•°è¯­å¥é€šå¸¸æ›´å¥½ã€‚ä¸è¿‡ï¼Œæƒ…å†µå¹¶éæ€»æ˜¯å¦‚æ­¤ã€‚

é™¤éä½ æ­£åœ¨å¤„ç†ç”Ÿæˆå™¨ï¼Œå¦åˆ™ä¸»è¦å½’ç»“ä¸º `this`ã€‚ä½ åœ¨å‡½æ•°å†…ä½¿ç”¨ `this` å…³é”®å­—å—ï¼Ÿå¦‚æœæ˜¯è¿™æ ·ï¼Œä½ éœ€è¦äº†è§£æ¯ç§ç±»å‹çš„å‡½æ•°å¦‚ä½•å¤„ç† `this` å…³é”®å­—ã€‚

åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œç®­å¤´å‡½æ•°å¾€å¾€æ›´ç®€æ´ã€‚è¿™ä½¿å¾—å®ƒä»¬éå¸¸é€‚åˆåŒ¿åå›è°ƒã€‚ä¾‹å¦‚ï¼Œå®ƒä»¬ä¸æ•°ç»„çš„ `.map()` æ–¹æ³•æˆ– `Promise.resolve()` é…åˆå¾—å¾ˆå¥½ã€‚**å¤§å¤šæ•°**æ—¶å€™ä½¿ç”¨ç®­å¤´å‡½æ•°æ˜¯å®‰å…¨çš„ã€‚ä½†æœ‰ä¸€äº›æƒ…å†µä½ å¯èƒ½æƒ³è¦å‡½æ•°è¯­å¥çš„çµæ´»æ€§ã€‚

ä¾‹å¦‚ï¼Œå‡è®¾æˆ‘ä»¬æ­£åœ¨å¤„ç†ä¸€ç»„ä¸åŒçš„å¯¹è±¡ã€‚æˆ‘ä»¬æƒ³è¦åˆ›å»ºä¸€ä¸ªç”Ÿæˆæ—¥å¿—çš„é€šç”¨æ–¹æ³•ã€‚æˆ‘ä»¬ä¸ºæ¯ç§å¯¹è±¡ç±»å‹å®šä¹‰ä¸€ä¸ª `toLogString()` æ–¹æ³•æ¥æ˜¾ç¤ºæ ‡ç­¾å’Œå¯¹è±¡çš„å½“å‰çŠ¶æ€ã€‚å¦‚æœæˆ‘ä»¬æ­£åœ¨ç¼–å†™ TypeScriptï¼Œæ¥å£å¯èƒ½çœ‹èµ·æ¥åƒè¿™æ ·ï¼š

```typescript
interface Loggable {
  toLogString(): string;
}
```

æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªå‡½æ•° `createLogMethod()`ã€‚å®ƒæ¥å—ä¸€ä¸ªæ ‡ç­¾ï¼Œå¹¶è¿”å›ä¸€ä¸ªå°†è®°å½•å¯¹è±¡å½“å‰çŠ¶æ€çš„æ–¹æ³•ã€‚å®ƒå¯èƒ½çœ‹èµ·æ¥åƒè¿™æ ·ï¼š

```javascript
function createLogMethod(label) {
  return function toLogString() {
    return `[${label}]: ${JSON.stringify(this)}`;
  }
}
```

æˆ‘ä»¬å¯ä»¥è¿™æ ·ä½¿ç”¨å®ƒï¼š

```javascript
class Book {
  constructor(title, author) {
    this.title = title;
    this.author = author;
  }
}

// æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç±»åŸå‹åˆ†é…æ–¹æ³•
Book.prototype.toLogString = createLogMethod('Book');

// æˆ–è€…ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªæ–¹æ³•å±æ€§
class Sensor {
  constructor(location, uri) {
    this.location = location;
    this.uri = uri;
  }

  toLogString = createLogMethod('Sensor');
}
```

ç„¶åæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªå‡½æ•° `log()`ï¼Œå®ƒå¯ä»¥ä¸ä»»ä½• `Loggable` å¯¹è±¡ä¸€èµ·å·¥ä½œï¼š

```javascript
/** @typedef {{ toLogString(): string }} Loggable */

/** Log
 * @param {Loggable} obj å®ç° Loggable æ¥å£çš„å¯¹è±¡
 */
const log = (obj) => console.log(obj.toLogString());
```

ç”±äº `log()` æ ¹æœ¬ä¸ä½¿ç”¨ `this` å…³é”®å­—ï¼Œä½¿ç”¨èƒ–ç®­å¤´å‡½æ•°æ˜¯å¯ä»¥çš„ã€‚æˆ‘ä»¬å¯ä»¥è¿™æ ·ä½¿ç”¨å®ƒï¼š

```javascript
const myBook = new Book(
  'The Hound of the Baskervilles',
  'Arthur Conan Doyle'
);

const mySensor = new Sensor(
  'Baker St',
  'http://example.com/sensors/baker-st'
);

log(myBook);
// íºµ [Book]: {"title":"The Hound of the Baskervilles","author":"Arthur Conan Doyle"}
log(mySensor);
// íºµ [Sensor]: {"location":"Baker St","uri":"http://example.com/sensors/baker-st"}
```

### å‡½æ•°è¯­å¥å’Œæå‡

è¿˜æœ‰å¦ä¸€ç§æƒ…å†µï¼Œä½ å¯èƒ½æ›´å–œæ¬¢å‡½æ•°è¯­å¥è€Œä¸æ˜¯ç®­å¤´å‡½æ•°ã€‚è¿™ç§æƒ…å†µä¸»è¦æ¶‰åŠæˆ‘ä»¬ä»£ç çš„å¯è¯»æ€§ã€‚ä¹Ÿè®¸æˆ‘ä»¬æƒ³è¦ç¼–å†™ä»£ç ï¼Œä½¿é«˜çº§ä»£ç é¦–å…ˆå‡ºç°ã€‚ç„¶åæˆ‘ä»¬ç¨åè·Ÿéšå®ç°ç»†èŠ‚ã€‚é€šå¸¸ï¼Œæˆ‘ä»¬ä¸èƒ½åœ¨å®šä¹‰ä¹‹å‰ä½¿ç”¨å‡½æ•°**è¡¨è¾¾å¼**æˆ–ç®­å¤´å‡½æ•°ã€‚ä½†æ˜¯ä½¿ç”¨å‡½æ•°**å£°æ˜**ï¼Œæˆ‘ä»¬æœ‰æ›´å¤šçš„çµæ´»æ€§ã€‚ä¾‹å¦‚ï¼š

```javascript
const EXCLUDED_WORDS = ['it', 'a', 'the', 'to', 'do', 'on', 'my', 'is', 'an' ];

function pigLatinifyText(str) {
  // ä¸‹é¢çš„ return è¯­å¥æ˜¯æˆ‘ä»¬å‡½æ•°çš„ä¸»ä½“
  // å®ƒè°ƒç”¨å°šæœªå®šä¹‰çš„å…¶ä»–å‡½æ•°
  // ä¸‹é¢çš„å‡½æ•°å®šä¹‰è¢«"æå‡"å¹¶è¢«è§†ä¸ºå·²åœ¨æ­¤æ³¨é‡Šä¸Šæ–¹ç¼–å†™
  return splitIntoWords()
    .map(latinifyWord)
    .join(' ');

  // é€šå¸¸ï¼Œreturn è¯­å¥ä¹‹åçš„æ‰€æœ‰å†…å®¹éƒ½è¢«å¿½ç•¥
  // ä½†ä¸‹é¢çš„å‡½æ•°è¯­å¥ä»ç„¶æœ‰æ•ˆ

  function splitIntoWords() {
    return str.split(' ');
  }

  function latinifyWord(word) {
    if (EXCLUDED_WORDS.includes(word)) return word;
    const [prefix, suffix] = partition(
      isConsonant,
      word.split('')
    );
    return `${suffix.join('')}${prefix.join('')}ay`;
  }

  function partition(p, arr) {
    // è¿™ä¸æ˜¯ç¼–å†™ partition() æœ€æœ‰æ•ˆçš„æ–¹æ³•ï¼Œä½†å®ƒèƒ½å®Œæˆä»»åŠ¡
    return [takeWhile(p, arr), dropWhile(p, arr)];
  }
}

const encoded = pigLatinifyText(
  'there is nothing more deceptive than an obvious fact'
);
console.log(encoded);
// íºµ erethay is othingnay oremay eceptiveday anthay an obviousay actfay
```

## æ€»ç»“

æˆ‘ä»¬ç°åœ¨å·²ç»ç ”ç©¶äº†ä¸€äº›ä½ å¯èƒ½æ›´å–œæ¬¢ä¸€ç§å‡½æ•°è¯­æ³•è€Œä¸æ˜¯å¦ä¸€ç§çš„ä½¿ç”¨æ¡ˆä¾‹ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æˆ‘ä»¬å­¦åˆ°çš„çŸ¥è¯†æ¥åˆ›å»ºä¸€ä¸ªæµç¨‹å›¾ï¼Œè¿™å°†å¸®åŠ©æˆ‘ä»¬ç¡®å®šä½¿ç”¨å“ªç§å‡½æ•°è¯­æ³•ã€‚

1. æˆ‘ä»¬é¦–å…ˆé—®ï¼š"æˆ‘ä»¬éœ€è¦ `yield` ä¸€ä¸ªå€¼å—ï¼Ÿ"ï¼ˆè¿™æ„å‘³ç€æˆ‘ä»¬æ­£åœ¨å¤„ç†ç”Ÿæˆå™¨ï¼‰ã€‚å¦‚æœæ˜¯"æ˜¯"ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¸èƒ½ä½¿ç”¨ç®­å¤´å‡½æ•°ã€‚
2. æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬é—®ï¼š"æˆ‘ä»¬éœ€è¦ä½¿ç”¨ `this` å…³é”®å­—å—ï¼Ÿ"å¦‚æœæ˜¯è¿™æ ·ï¼Œæˆ‘ä»¬**å¯èƒ½**æƒ³è¦åœ¨ `class` å£°æ˜å†…ä½¿ç”¨æ–¹æ³•è¯­æ³•ã€‚ä½†æ˜¯ï¼Œå¯èƒ½æœ‰ä¸€äº›æƒ…å†µï¼Œ`function` å…³é”®å­—ä¼šç»™æˆ‘ä»¬æ›´å¤šçš„çµæ´»æ€§ã€‚æ— è®ºå“ªç§æ–¹å¼ï¼Œæˆ‘ä»¬å¯èƒ½**ä¸**æƒ³è¦ä½¿ç”¨ç®­å¤´å‡½æ•°ã€‚
3. æˆ‘ä»¬æœ‰ç†ç”±åœ¨ç¼–å†™å‡½æ•°ä¹‹å‰ä½¿ç”¨å®ƒä»¬å—ï¼Ÿä¹Ÿè®¸æ˜¯ä¸ºäº†åˆ›å»ºç‰¹å®šçš„é˜…è¯»é¡ºåºï¼Ÿä¸€ä¸ªåœ¨è¿›å…¥ç»†èŠ‚ä¹‹å‰æ¦‚è¿°è®¡ç®—çš„å¤§æƒ³æ³•çš„é¡ºåºï¼Ÿå¦‚æœæ˜¯è¿™æ ·ï¼Œé‚£ä¹ˆä½¿ç”¨å‡½æ•°å£°æ˜ï¼ˆæˆ–å…¶ä»–æå‡æ–¹æ³•ï¼‰å¯èƒ½ä¼šæœ‰æ‰€å¸®åŠ©ã€‚
4. å¦åˆ™ï¼Œèƒ–ç®­å¤´å‡½æ•°å¯èƒ½ä¼šå¾ˆå¥½ï¼Œå¹¶ä¸”æ›´ç®€æ´ã€‚

å½“ç„¶ï¼Œè¿™äº›åªæ˜¯æˆ‘çš„å»ºè®®ã€‚ä½ å¯ä»¥è‡ªç”±åœ°ä»¥ä»»ä½•æœ‰æ•ˆçš„æ–¹å¼ç¼–å†™ä»£ç ã€‚ä½ ç”šè‡³å¯ä»¥è‡ªç”±åœ°ä»¥ä¸èµ·ä½œç”¨çš„æ–¹å¼ç¼–å†™ä»£ç ï¼Œå¦‚æœä½ é€‰æ‹©è¿™æ ·åšçš„è¯ã€‚

---

*åŸæ–‡é“¾æ¥ï¼šhttps://jrsinclair.com/articles/2025/whats-the-difference-between-named-functions-and-arrow-functions/*
